#### **No.1251-平均售价**:
1. **力扣链接**：https://leetcode.cn/problems/average-selling-price/description/
2. **题目说明**
    - //todo
3. **答案**（纯代码）： 
      
    ```sql
    # Write your MySQL query statement below
    # Method One: LEFT JOIN + GROUP BY + IFNULL
    -- You need to move the date condition from the WHERE clause 
    -- into the ON clause of the LEFT JOIN. This ensures that 
    -- the LEFT JOIN still includes all products from Prices, 
    -- and the filtering only applies when there are 
    -- actual matching UnitsSold records.
    SELECT
        `Prices`.`product_id`,
        IFNULL(ROUND(SUM(`units` * `price`) / SUM(`units`), 2), 0) AS `average_price`
    FROM 
        `Prices`
    LEFT JOIN
        `UnitsSold` ON `Prices`.`product_id` = `UnitsSold`.`product_id` AND
        (`purchase_date` BETWEEN `start_date` AND `end_date`)
    GROUP BY 
        `product_id`;

    # -------------------------
    # Method Two : LEFT JOIN + GROUP BY + CASE
    SELECT
        `Prices`.`product_id`,
        CASE
            WHEN SUM(`units`) = 0 OR SUM(`units`) IS NULL THEN 0
            ELSE ROUND(SUM(`units` * `price`) / SUM(`units`), 2)
        END AS `average_price`
    FROM 
        `Prices`
    LEFT JOIN
        `UnitsSold` ON `Prices`.`product_id` = `UnitsSold`.`product_id` AND
        (`purchase_date` BETWEEN `start_date` AND `end_date`)
    GROUP BY 
        `product_id`;

    # -------------------------
    # Method Three : LEFT JOIN + GROUP BY + IF
    SELECT
        `Prices`.`product_id`,
        IF(SUM(`units`) = 0 OR SUM(`units`) IS NULL, 0, ROUND(SUM(`units` * `price`) / SUM(`units`), 2)) AS `average_price`
    FROM 
        `Prices`
    LEFT JOIN
        `UnitsSold` ON `Prices`.`product_id` = `UnitsSold`.`product_id` AND
        (`purchase_date` BETWEEN `start_date` AND `end_date`)
    GROUP BY 
        `product_id`;

    # -------------------------
    # Method Four : SubQuery
    SELECT 
        `product_id`,
        IFNULL(ROUND(SUM(`sales`) / SUM(`units`), 2), 0) AS `average_price`
    FROM (
        SELECT
            `P`.`product_id`,
            `US`.`units` * `P`.`price` AS `sales`,
            `US`.`units`
        FROM
            `Prices` `P`
        LEFT JOIN
            `UnitsSold` `US` ON `P`.`product_id` = `US`.`product_id` AND
            (`US`.`purchase_date` BETWEEN `P`.`start_date` AND `P`.`end_date`)
    ) `Temp`
    GROUP BY 
        `product_id`;
    ```
4. **思路及解析**：
    - //todo