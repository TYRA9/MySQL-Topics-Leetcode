#### **No.1789-员工的直属部门**:
1. **力扣链接**：https://leetcode.cn/problems/primary-department-for-each-employee/description/
2. **题目说明**
    - //todo
3. **答案**（纯代码）： 
      
    ```sql
    # Write your MySQL query statement below
    # Method One: UNION (合并查询)
    SELECT
        `employee_id`,
        `department_id`
    FROM
        `Employee`
    WHERE
        `primary_flag` = 'Y'

    UNION

    SELECT
        `employee_id`,
        MAX(`department_id`)
    FROM
        `Employee`
    GROUP BY
        `employee_id`
    HAVING 
        COUNT(*) = 1;

    # ------------------------------
    # Method Two: Window Function
    SELECT 
        employee_id, 
        department_id
    FROM (
        SELECT 
            *, 
            COUNT(*) OVER(PARTITION BY employee_id) AS dept_count
        FROM Employee
    ) AS temp
    WHERE primary_flag = 'Y' OR dept_count = 1;


    # ------------------------------
    # Method Three: Subquery
    SELECT
        `employee_id`,
        `department_Id`
    FROM
        `Employee`
    WHERE
        `primary_flag` = 'Y' 
        OR `employee_id` IN (
            SELECT `employee_id`
            FROM `Employee`
            GROUP BY `employee_id`
            HAVING COUNT(*) = 1
        )
    ```
4. **思路及解析**：
    - //todo